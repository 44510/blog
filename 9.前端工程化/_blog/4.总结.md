## 总结

通过这个插件的开发，整体的学习了一下webpack的配置及babel的使用，以及ast的使用；

学习一下vue ui这块的操作。

vue ui，直接运行的到结果。

分析babel，可以更加深刻的理解js的执行原理。

如果说Compiler是流程，那么Compilation就是编译主场了。也就是源代码经过他加工之后才得到了升华变成了规规矩矩的模样。

修改文件：

1. 直接修改一个jsx或者js/css文件；
2. 配合插件进行修改；

分析几个常用的插件，比如移除consolelog的插件，比如cssmin等；

开发一个插件，删除debugger, DebuggerStatement

分析一个loader和plugin的源码

这里其实经过webpack的loader处理后，已经很难再解开然后修改代码了，要修改似乎只能修改服务的文件了。

一个核心的问题，如何在loader处理前对文件进行处理，或者如何处理loader处理后的文件。

### NormalModuleFactory

Compiler 使用 NormalModuleFactory 模块生成各类模块。从入口点开始，此模块会分解每个请求，解析文件内容以查找进一步的请求，然后通过分解所有请求以及解析新的文件来爬取全部文件。在最后阶段，每个依赖项都会成为一个模块实例。

<https://www.webpackjs.com/api/compiler-hooks/#normalmodulefactory>
<https://webpack.docschina.org/api/normalmodulefactory-hooks/>
<!-- https://juejin.cn/post/7046360070677856292 -->

## 与这个插件类似

<https://www.npmjs.com/package/modify-source-webpack-plugin>

## 资源替换常用插件，如替换小程序项目中的appid的操作

/Users/qiuwww/code/learn/blog/9.前端工程化/webpack/wepack4构建分析/plugin/assets-replace-plugin.js

借助`compiler.hooks.emit.tap('AssetsReplacePlugin'`直接操作。

### 分析一下compilition的生命周期

## 其他的一些理解

1. webpack 与 vite
   1. vite的优势就是开发过程中几乎不需要编译，直接运行到了浏览器；
   2. 而Vite则采用了基于ES Module的开发服务器，只有在需要时才会编译对应的模块，大幅度提升了开发环境的响应速度；
   3. webpack配置相对复杂，插件的开发要对webpack有深入的理解；

## 参考文档

1. [webpack官方文档](https://webpack.docschina.org/concepts/)；
2. [webpack5 和 webpack4 的区别有哪些](https://www.cnblogs.com/Hsong/p/15894515.html)；
3. [webpack自定义插件](https://webpack.docschina.org/contribute/writing-a-plugin/)
4. [Compilation Object](https://webpack.docschina.org/api/compilation-object/)
5. [如何利用AST树修改源码](https://juejin.cn/post/6904228580172627975)
6. [webpack插件开发及修改源码的几种方式](https://www.haorooms.com/post/webpack_plugin_changcode)，重要；
7. [小程序 webpack 插件](https://github.com/listenzz/MyMina/blob/master/README.md)；
8. [从Webpack源码探究打包流程，萌新也能看懂](https://cloud.tencent.com/developer/article/1410197)；
9. [通过webpack插件修改代码全攻略](https://juejin.cn/post/7268164970410754063#heading-13)

## 在webpack的生命周期的哪个阶段可以修改ast树

在 Webpack 的生命周期中，可以在"Transform"阶段修改 AST 树。
Webpack 的生命周期分为多个阶段，其中"Transform"阶段是在代码被解析成抽象语法树（AST）之后，但在代码被生成之前。在这个阶段，Webpack 会调用插件的"transform"方法，这些方法可以对 AST 树进行修改。
Webpack 插件可以通过配置来指定在"Transform"阶段执行，例如：

```js
module: {
  rules: [
    {
      test: /\.js$/,
      use: [
        'babel-loader',
        {
          loader: 'webpack-strip-comments-loader',
          options: {
            enabled: true
          }
        }
      ]
    }
  ]
}

```

## 浅析webpack5中Compiler中重要的hook调用过程

<https://blog.csdn.net/qq_41581588/article/details/129580272>
