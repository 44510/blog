## 搭建 webpack 基础开发环境

接下来就从 0 来搭建一个 webpack5 的开发环境，首先我们要了解一下主要的配置点。

### 搭建 webpack 开发环境应该关注的方面 / 配置相关核心概念

webpack 至少需要两套配置，一个用来开发，一个用来打包成线上运行的代码；

1. entry：入口起点(entry points)，所有内容的起点，资源读取解析的入口；
   1. 支持单文件入口、数组 、对象语法这三种形式；
2. output：告知 webpack 如何向硬盘写入编译文件，用于指定在打包后生成的文件的 URL 路径，不同于 entry，这里只能有一个地址；
   1. path 用于指定存放结果的目录；
   2. 通常可以通过配置 filename 来配置输出文件的文件名形式，如`filename: '[name]-[hash:6].js',`表示文件名加 hash 的形式，文件修改后 hash 会响应改变；
   3. publicPath 这个属性，通常在 dev 和 prod 环境下是不同的，表示当前文件的引用根地址，通常情况下，开发服务器配置`publicPath: '/'`，而在 build 后的文件夹，如果 dist 目录整体部署，通常引用资源文件都是相对地址，都需要配置`publicPath: './'`；
3. module.rules：用来配置 loader 这些，用于指定不同类型的文件的处理方式。loader 是 Webpack 的一个关键概念，**它们用于处理不同类型的模块**。加载器允许你在加载模块之前对其进行转换或处理；
   1. loader 用于对模块的源代码进行转换。
   2. 在基础项目中，需要不同的 loader 去处理不同类型的文件，最基础的是`babel-loader`，通常用作处理 js，其他常用如：`less-loader`、`style-loader`、`file-loader`、`vue-loader`等；
   3. 多个 loader 从后往前一次套用；
4. plugins：插件是 Webpack 的另一个关键概念，**它们用于执行各种任务，从而优化和定制构建过程**。插件可以用于生成 HTML 文件、提取 CSS、代码分割、代码压缩等任务，这个就是主要干活的；
5. resolve：用于定义如何解析模块路径以及确定模块的位置；
6. mode：是 webpack5 新增的一个配置，相当于 webpack 预设的一些对应环境的优化手段；
   1. 有'development'、'production'和'none'三种模式；
7. devServer：是一个用于开发环境的 Webpack 插件，它提供了一个内置的开发服务器，用于快速开发和测试你的前端应用程序。
8. devtool：用于控制生成源代码映射文件，以便在开发和调试过程中更轻松地定位和解决问题。源代码映射文件允许你在浏览器中调试与转换后的代码对应的源代码，从而更容易识别错误和问题。
9. 其他还有一些配置，这里不一一列举；

详细参考可以查看[官方文档](https://webpack.docschina.org/concepts/)，这里只做简单的说明。

### 上手操作

```bash
# 1.添加基本的项目构建
$: cd target-folder
$: mkdir webpack5-modify-assets
$: cd webpack5-modify-assets/
$: git init
$: yarn init -y
$: mkdir src scripts public
$: echo node_modules > .gitignore
$: echo dist >> .gitignore
$: touch public/index.html
$: touch scripts/webpack.config.base.js
$: touch src/index.js
```

1. 然后在入口`public/index.html`和`src/index.js`添加基础的内容；
2. 在`scripts/webpack.config.base.js`进行基础的配置；
3. 添加`babel.config.js`文件；
4. 添加`package.scripts`执行命令；
5. 添加必要的依赖包，包括 webpack 相关、babel 相关、loader；
6. 参考[webpack cli 文档](https://webpack.docschina.org/api/cli/)来了解 Webpack CLI 的使用方式；

```bash
/webpack/webpack-demo/webpack5-modify-assets
├── babel.config.js # babel-loader的插件配置文件
├── package.json
├── dist # 打包的文件目录
├── public
|  ├── favicon.ico
|  └── index.html
├── scripts
|  ├── babelModify.js # 用作处理code
|  ├── loader-modify.js # loader
|  ├── plugin-modify.js # 插件
|  ├── webpack.config.base.js # webpack基础配置
|  ├── webpack.config.dev.js # 开发环境
|  └── webpack.config.prod.js # 生产环境
├── src # 要处理的代码
|  ├── ast.js
|  ├── index.js
|  └── modify-by-plugin.js
└── yarn.lock
```

[具体参考代码](https://github.com/qiuwww/blog/blob/57ad5d7cf43764dcae8a8d310c3b358b5c1467fb/9.%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/webpack/webpack-demo/webpack5-modify-assets)。
