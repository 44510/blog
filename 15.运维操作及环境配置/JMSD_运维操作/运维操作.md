# 运维操作

1. whereis nginx
2. cat /etc/redhat-release，查看系统版本

## 如何快速了解一个服务器的信息<https://www.cnblogs.com/ggjucheng/archive/2013/01/14/2859613.html>

如内存、闪存、硬盘、系统、CPU、内存占用、进程等。

比如服务器：

1. IP：119.37.199.165
2. 端口：22
3. 账号：root
4. 密码：yiming2022!@#$GC0217!!!

```bash
# 查看当前的系统
cat /proc/version

# Linux version 3.10.0-327.el7.x86_64 (builder@kbuilder.dev.centos.org) (gcc version 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC) ) #1 SMP Thu Nov 19 22:10:57 UTC 2015

# yum是否可用
yum

# 查看cpu参数
lscpu

# 查看每个cpu
cat /proc/cpuinfo

# 内存，闪存
free -m

# 查看内存硬件信息
dmidecode -t memory

# 磁盘
lsblk

# 查看ip
ip addr show

# 当前运行的进程
ps aux | less

# 查看当前服务的端口/启动的服务
# linux系统查看当前正在运行的服务<https://blog.51cto.com/u_15328720/3384523>

# Linux 查看端口占用情况 <https://www.runoob.com/w3cnote/linux-check-port-usage.html>
lsof -i

netstat -tunlp | grep 8080

# 杀掉某个进程
kill -9 26993(PID)
```

## 文件目录说明

linux 系统根目录下各个目录用途说明：

1、/ 根目录 --------- 所有目录挂在其下

2、/boot --------- 存放 Ubuntu 内核和系统启动文件。系统启动时这些文件先被装载。

3、/etc --------- 系统的配置文件目录。密码文件、设置网卡信息、环境变量的设置等都在此目录中，许多网络配置文件也在其中。

4、/lib --------- 根文件系统目录下程序和核心模块的共享库。这个目录里存放着系统最基本的动态链接共享库，类似于 Windows 下的 system32 目录，几乎所有的应用程序都需要用到这些共享库。

5、/media --------- 主要用于挂载多媒体设备。ubuntu 系统自动挂载的光驱、usb 设备，存放临时读入的文件。

6、/proc --------- 这个目录是系统内存的映射，我们可以直接访问这个目录来获取系统信息。也就是说，这个目录的内容不在硬盘上而是在内存里。

7、/sbin --------- s 就是 Super User 的意思，这里存放的是系统管理员使用的系统管理程序，如系统管理、目录查询等关键命令文件。

8、/tmp --------- 这个目录是用来存放一些临时文件的，所有用户对此目录都有读写权限。

9、/home --------- 用户的主目录。下面是自己定义的用户名的文件夹。每个用户的设置文件，用户的桌面文件夹，还有用户的数据都放在这里。

10、/mnt --------- 此目录主要是作为挂载点使用。通常包括系统引导后被挂载的文件系统的挂载点。如挂载 Windows 下的某个分区。

11、 **opt 目录** ------ /opt 目录用来安装附加软件包，是用户级的程序目录，**可以理解为 D:/Software。\*\***安装到/opt 目录下的程序，它所有的数据、库文件等等都是放在同个目录下面。**opt 有可选的意思，这里可以用于放置第三方大型软件（或游戏），**当你不需要时，直接 rm -rf 掉即可。\*\*在硬盘容量不够时，也可将/opt 单独挂载到其他磁盘上使用。

12、/usr/local：用户级的程序目录，可以理解为 C:/Progrem Files/。用户自己编译的软件默认会安装到这个目录下。 这里主要存放那些手动安装的软件。

runoob 教程：<https://www.runoob.com/linux/linux-system-contents.html>

### linux 与 window 目录对应关系

## yum

1. [介绍](https://www.runoob.com/linux/linux-yum.html)；

## 部署 git

```bash
yum install git -y

uname -a
# Linux 5GtReyS8qv 3.10.0-327.el7.x86_64 #1 SMP Thu Nov 19 22:10:57 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux

mkdir /home/qiuwww

cd /home/qiuwww

git status

git clone https://www.heikemen.cn/gitlab/jmsd/app.git

git checkout -b prod/qiu_node
git branch --set-upstream-to=origin/prod/qiu_node prod/qiu_node

# 如果有未提交的执行如下命令：
git chckout .
git clean -fd
```

## nodejs 部署

@\_docs/运维操作/Node.js 安装.md

## anywhere 配置软连接 / anywhere 启动 spawn xdg-open ENOENT

1. anywhere -p 9000 -s
   1. 这里要添加-s 命令，表示不打开浏览器，不然会报错的；

## 部署 mysql 服务

@\_docs/运维操作/MySQL 操作.md

## 部署 nginx 服务

@\_docs/运维操作/Nginx 使用.md

nginx 安装成功后的位置如下:

- /usr/sbin/nginx：主程序
- /etc/nginx：配置文件所在路径
- /usr/share/nginx：静态文件所在路径
- /var/log/nginx：日志文件所在路径

部署 nginx:

[阿里云安装配置 nginx](https://www.cnblogs.com/anenyang/p/11194667.html)

<https://blog.csdn.net/WithCYwind/article/details/103818478>

这里可以将服务端口都转为子域名访问。

```bash

:3000 -> test.qiuww.site
:7001 -> data-collection.qiuww.site

/etc/nginx/nginx.conf 配置日志等
/etc/nginx/sites-available/default 配置项目路径等
```

### 启动软件并设置开机启动

1. systemctl enable nginx
2. systemctl start nginx
3. 启动命令 start nginx
4. 重新启动命令 nginx -s reload

### 端口对外部可访问

查看端口的情况：`netstat -tunlp | grep 80` 查看所有端口的访问：`netstat -tunlp`

### 403 Forbidden nginx

三、权限问题，如果 nginx 没有 web 目录的操作权限，也会出现 403 错误。解决办法：修改 web 目录的读写权限，或者是把 nginx 的启动用户改成目录的所属用户，重启 Nginx 即可解决

1. chmod -R 777 /data
2. chmod -R 777 /data/img
3. chmod -R 777 /home/code

### nginx 配置跨域

add_header 'Access-Control-Allow-Origin' '\*' always; add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS,PUT,DELETE,OPTION'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Headers' 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization,Accept,Referer,Accept-Encoding,Accept-Language,Access-Control-Request-Headers,Access-Control-Request-Method,Connection,Host,Origin,Sec-Fetch-Mode';

### linux 端口外部访问不，防火墙没开，导致 80 端口不能被访问到

```bash
# cd到linux 的etc/sysconfig目录下执行以下语句 则在外网上就可以访问此端口了：
firewall-cmd --permanent --add-port=80/tcp 其中80 是你想要访问的端口
firewall-cmd --reload

# 直接关闭防火墙的命令：
systemctl stop firewalld.service
```

### 这里出现了一个 nginx 一直不能访问到前端代码的问题

#### 问题处理思路

1. 查看默认位置的`/etc/nginx/nginx.conf`文件配置，如果这里改动了很多次（像我一样）还是没有效果，那么就要考虑是不是这里的问题了；
2. **查看 nginx 的日志文件**`tail -f /var/log/nginx/error.log`，
3. 查看 nginx 当前的依赖的配置文件：
   1. Nginx 配置不生效时，一般去看看错误日志；
   2. 这里的错误信息提示/usr/share/nginx/html/h5/index.html，也就是走的默认 root；
4. vhost 文件夹是干嘛的？
   1. 这个配置的关键是，在 vhost 目录下，你这个 conf 文件生效了
   2. `/etc/nginx/vhost/jmsd-api.conf`，这里的文件覆盖了`/etc/nginx/nginx.conf`这里的配置；
   3. 你 server_name 指定了 ip，也就是说 ip 访问时，这里是最高响应优先级
   4. 在这里把 h5 那个配置加上就可以了
   5. 这两边都添加一下就可以了。

注意区分：

```conf
location /h5 {
   alias /home/code/h5;
}
location /h5 {
   root /home/code;
}
```

### 上传文件提示 413 Request Entity Too Large 错误

1. <https://blog.csdn.net/m0_37899908/article/details/125015061>

这个时候是因为 nginx 的问题，限制了。所以添加配置`client_max_body_size 100M;`；

## vi 中的搜索

/搜索内容

## linux work文件夹路径的设置
