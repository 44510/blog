# 如何允许外网访问本地的接口服务

主要用在处理，三方服务回调我们的服务的时候的处理，麻烦点在于开发时候的 ip 访问形式。

## 步骤

1. 登录路由器的访问地址；
   1. 查找当前网络的路由器 ip；
   2. 添加端口映射，将对路由器 ip 的端口访问转发到当前局域网下的服务 ip 指定端口上；
2. 局域网内的用户可以通过 ip 直接访问；
3. 最终结果：`http://36.22.242.167:7001/` (转发到局域网内的)=> `http://192.168.31.234:7001/`。

## tplink

一、我们进入路由器，查看我们的路由的 WAN 口的 IP 地址。 Wan 口这个 IP（27.40.127.248）就是外网用户可以唯一识别你电脑地址的路由 IP，但是一个路由一般都同时连接着几部电脑，这又怎么让访问者找到你呢，这就需要到了端口映射。

端口映射又称端口转发。端口映射过程就如同你家在一个小区里 T 栋 112 室，你朋友来找你，找到小区门口，不知道你住哪层哪号？就问小区的保安，保安就告诉了他你家详细门牌号，这样你朋友很轻松的找到了你家。这个保安就是就路由器，这个过程就是外网访问内网通过端口映射的形象比喻。

然后我们再在 TP-Link 路由里面找到它的端口映射功能，这个端口映射所在位置是“转发规则”里面的“虚拟服务器”（每个牌子的路由的名字都不一样，请大家自己详细找找），然后添加转发条目，如下图：虚拟服务 80 端口转发在我的 TP-Link 下面，我已经添加了两条条目，就分别是 80 端口和 8080 端口的转发到内网 192.168.1.112 在台电脑，现在只要用户通过 80 或者 8080 这两个端口访问路由的 IP，那路由就会把用户转向 192.168.1.112 这台电脑所在本地服务器。端口映射除了 Web 服务器可以做这样的设置，FTP 也可以做类似的转发，FTP 的默认端口是 21。
