---
title: 一文了解文件上传全过程
keyword: multipart/form-data、application/x-www-form-urlencoded、application/json
---

## 什么是 multipart/form-data

1. 旧有的 application/x-www-form-urlencoded，此类型不适合用于**传输大型二进制数据或者包含非 ASCII 字符的数据**。
2. 平常我们使用这个类型都是**把表单数据使用 url 编码后传送给后端**，二进制文件当然没办法一起编码进去了。所以 multipart/form-data 就诞生了，专门用于有效的传输文件。
3. 其实我认为，无论你用什么都可以传（application/json），**只不过会要综合考虑一些因素的话，multipart/form-data 更好**。

### multipart/form-data 规范是什么

```js
Content-type: multipart/form-data, boundary=AaB03x

--AaB03x
content-disposition: form-data; name="field1"
Joe Blow
--AaB03x
content-disposition: form-data; name="pics"; filename="file1.txt"
Content-Type: text/plain

... contents of file1.txt ...
--AaB03x--
```

1. 首先是请求类型，然后是一个 boundary （分割符）；
2. 然后再接下来就是声明内容的描述是 form-data 类型，**字段名字是啥**；
   1. **如果是文件的话，得知道文件名是啥，还有这个文件的类型是啥**；

## application/json

1. application/json 是以**文本形式**进行传输；

### application/json 来传输文件

1. 前端：某种意义上我们确实可以将文件转成例如文本形式的 Base64 形式；
2. **后端也需要按照你这样传输的形式，做特殊的解析**；
3. 并且文本在传输过程中是相比二进制效率低的，那么对于我们动辄几十 M 几百 M 的文件来说是速度是更慢的。

## 文件上传

### 请求端

#### File

```html
<form action="http://localhost:7787/files" method="POST">
    <input name="file" type="file" id="file">
    <input type="submit" value="提交">
</form>
```

### 接收端

## 参考

1. [一文了解文件上传全过程（1.8w 字深度解析，进阶必备）](https://segmentfault.com/a/1190000037411957)
