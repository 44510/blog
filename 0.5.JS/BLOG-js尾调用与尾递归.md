---
title: js尾调用与尾递归
date: 2017-02-02
tags:
  - 算法
---

## 尾调用

尾调用是函数式编程中一个很重要的概念，当一个函数执行时的最后一个步骤是返回另一个函数的调用，这就叫做尾调用。

```js
const a = x => (x ? f() : g());
// f() 和 g() 都在尾部。
```

## 尾递归

当一个函数**尾调用自身**，就叫做尾递归。

### 尾递归举例

如下阶乘计算。

```js
// 这个时候需要保存n个调用记录，复杂度为O(n)，这里会依次保存上一个函数的运行结果在栈中。
// 函数调用会产生“调用记录（存储着函数的相关信息）”存放在栈中，当有函数返回，对应的调用记录才会消失，上述用普通递归实现的阶乘的执行过程中，不断的调用自身，导致一直没有返回，这样也就不断的在栈中存储调用记录而当调用自身的次数过多后，就会产生我们常说的“栈溢出”。

function factorial(n) {
  if (n === 1) {
    return 1;
  }
  return n * factorial(n - 1);
}
factorial(10);

// 永远只有一个调用记录，调用函数产生一个调用记录，最后一步操作 return fac(n - 1, n * total) 把当前函数的计算结果当做参数传递给了下一个自身调用，这样第一个函数调用产生的调用记录就消失了，因为它执行完了，依次类推，就不会溢出。

function endFactorial(m, total) {
  if (m === 1) {
    return total;
  }
  return endFactorial(m - 1, m * total);
}
endFactorial(10, 1);
```
