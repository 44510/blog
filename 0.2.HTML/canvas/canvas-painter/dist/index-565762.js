(()=>{"use strict";var e={705:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);i&&s[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),t.push(c))}},t}},476:e=>{e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(r," */");return[t].concat([o]).join("\n")}return[t].join("\n")}},311:(e,t)=>{t.ControlColor="#00FF00"},901:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=i(n(626)),a=i(n(803)),l=i(n(368)),u=i(n(467)),c=n(721);var d=function(e){(0,s.default)(u,e);var t,n,i=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.default)(t);if(n){var r=(0,l.default)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.default)(this,e)});function u(e,t,n){return(0,r.default)(this,u),i.call(this,e,t,n)}return(0,o.default)(u,[{key:"draw",value:function(e){c.Util.drawArrow(e,this.start.x,this.start.y,this.end.x,this.end.y,this.config.strokeStyle),this.selected&&this.drawSelected(e)}}]),u}(u.default);t.default=d},514:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=function(){function e(t){(0,r.default)(this,e),this.config=t||{},this.selected=!1,this.selectedPoint=null}return(0,o.default)(e,[{key:"setSelected",value:function(e,t){this.selected=e,this.selectedPoint=t}},{key:"getSelected",value:function(){return this.selected}},{key:"selectedMoveHandler",value:function(e){}},{key:"isValid",value:function(){}},{key:"isSelected",value:function(e){}},{key:"setConfig",value:function(e){this.config=e}}]),e}();t.default=s},751:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=i(n(626)),a=i(n(803)),l=i(n(368)),u=i(n(643)),c=n(721);var d=function(e){(0,s.default)(u,e);var t,n,i=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.default)(t);if(n){var r=(0,l.default)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,a.default)(this,e)});function u(e,t,n){return(0,r.default)(this,u),i.call(this,e,t,n)}return(0,o.default)(u,[{key:"draw",value:function(e){var t=this.getPoints(),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY,s=(r-n)/2,a=(o-i)/2,l=(r+n)/2,u=(o+i)/2;c.Util.drawEllipse(e,l,u,s,a,this.config.fillStyle,this.config.strokeStyle),this.selected&&this.drawSelected(e)}}]),u}(u.default);t.default=d},467:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=i(n(52)),a=i(n(626)),l=i(n(803)),u=i(n(368)),c=i(n(514)),d=n(721),f=n(311);var h=function(e){(0,a.default)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.default)(t);if(n){var r=(0,u.default)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,l.default)(this,e)});function c(e,t,n){var o;return(0,r.default)(this,c),(o=i.call(this,n)).start=e,o.end=t,o}return(0,o.default)(c,[{key:"draw",value:function(e){e.save(),e.beginPath(),e.moveTo(this.start.x,this.start.y),e.lineTo(this.end.x,this.end.y),e.strokeStyle=this.config.strokeStyle,e.lineWidth=.5,e.stroke(),e.restore(),this.selected&&this.drawSelected(e)}},{key:"drawSelected",value:function(e){e.save(),e.beginPath(),e.fillStyle=f.ControlColor,e.fillRect(parseInt(this.start.x,10)-3.5,parseInt(this.start.y,10)-3.5,6,6),e.rect(parseInt(this.start.x,10)-3.5,parseInt(this.start.y,10)-3.5,6,6),e.stroke(),e.beginPath();var t=this.getPoints(),n=t.minX,i=t.minY,r=(n+t.maxX)/2,o=(i+t.maxY)/2;e.beginPath(),e.fillStyle=f.ControlColor,e.fillRect(parseInt(r,10)-3.5,parseInt(o,10)-3.5,6,6),e.rect(parseInt(r,10)-3.5,parseInt(o,10)-3.5,6,6),e.stroke(),e.beginPath(),e.fillStyle=f.ControlColor,e.fillRect(parseInt(this.end.x,10)-3.5,parseInt(this.end.y,10)-3.5,6,6),e.rect(parseInt(this.end.x,10)-3.5,parseInt(this.end.y,10)-3.5,6,6),e.stroke(),e.restore()}},{key:"update",value:function(e,t){this.start=e||this.start,this.end=t||this.end}},{key:"isSelected",value:function(e){var t=this.getPoints(),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;if(n-=5,i-=5,r+=5,o+=5,e.x>=n&&e.x<=r&&e.y>=i&&e.y<=o){var s=d.Util.distance(this.start,this.end),a=d.Util.distance(this.start,e),l=d.Util.distance(this.end,e),u=(a+l+s)/2;return 2*Math.sqrt(u*(u-a)*(u-l)*(u-s))/s<=5}return!1}},{key:"setSelected",value:function(e,t){(0,s.default)((0,u.default)(c.prototype),"setSelected",this).call(this,e,t),e?(this.prevStart=this.start.clone(),this.prevEnd=this.end.clone()):(this.prevStart=null,this.prevEnd=null)}},{key:"getPoints",value:function(){return d.Util.getMaxMin(this.start,this.end)}},{key:"selectedMoveHandler",value:function(e){if(Math.abs(this.selectedPoint.x-this.prevStart.x)<=5&&Math.abs(this.selectedPoint.y-this.prevStart.y)<=5)this.start=e;else if(Math.abs(this.selectedPoint.x-this.prevEnd.x)<=5&&Math.abs(this.selectedPoint.y-this.prevEnd.y)<=5)this.end=e;else{var t=this.selectedPoint.x-e.x,n=this.selectedPoint.y-e.y;this.start.x=this.prevStart.x-t,this.end.x=this.prevEnd.x-t,this.start.y=this.prevStart.y-n,this.end.y=this.prevEnd.y-n}}}]),c}(c.default);t.default=h},643:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=i(n(143)),a=i(n(52)),l=i(n(626)),u=i(n(803)),c=i(n(368)),d=i(n(514)),f=n(721),h=n(311);var v=function(e){(0,l.default)(d,e);var t,n,i=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.default)(t);if(n){var r=(0,c.default)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,u.default)(this,e)});function d(e,t,n){var o;return(0,r.default)(this,d),(o=i.call(this,n)).start=e,o.end=t,o.minWidth=20,o.minHeight=20,console.log("React被创建：",(0,s.default)(o)),o}return(0,o.default)(d,[{key:"draw",value:function(e){e.save();var t=Math.abs(this.start.x-this.end.x),n=Math.abs(this.start.y-this.end.y),i=Math.min(this.start.x,this.end.x),r=Math.min(this.start.y,this.end.y);this.config.fillStyle&&(e.fillStyle=this.config.fillStyle,e.fillRect(i-.5,r-.5,t,n)),e.strokeStyle=this.config.strokeStyle,e.strokeRect(i-.5,r-.5,t,n),e.restore(),this.selected&&this.drawSelected(e)}},{key:"drawSelected",value:function(e){var t=this.getAllControlPoints();e.save(),t.forEach((function(t){e.beginPath(),e.fillStyle=h.ControlColor,e.fillRect(parseInt(t.x,10)-3.5,parseInt(t.y,10)-3.5,6,6),e.rect(parseInt(t.x,10)-3.5,parseInt(t.y,10)-3.5,6,6),e.stroke()})),e.restore()}},{key:"update",value:function(e,t){this.start=e||this.start,this.end=t||this.end}},{key:"getPoints",value:function(e,t){return e=e||this.start,t=t||this.end,f.Util.getMaxMin(e,t)}},{key:"getAllControlPoints",value:function(e,t){var n=this.getPoints(e,t),i=n.minX,r=n.minY,o=n.maxX,s=n.maxY,a=o-i,l=s-r,u=[];return u.push({x:i,y:r}),u.push({x:i+a/2,y:r}),u.push({x:o,y:r}),u.push({x:o,y:r+l/2}),u.push({x:o,y:s}),u.push({x:i+a/2,y:s}),u.push({x:i,y:s}),u.push({x:i,y:r+l/2}),u}},{key:"setSelected",value:function(e,t){(0,a.default)((0,c.default)(d.prototype),"setSelected",this).call(this,e,t),e?(this.prevStart=this.start.clone(),this.prevEnd=this.end.clone()):(this.prevStart=null,this.prevEnd=null)}},{key:"isSelected",value:function(e){var t=this.getPoints(),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return n-=5,i-=5,r+=5,o+=5,e.x>=n&&e.x<=r&&e.y>=i&&e.y<=o}},{key:"selectedMoveHandler",value:function(e){var t=this,n=this.getAllControlPoints(this.prevStart,this.prevEnd),i=!1,r=-1;if(n.forEach((function(e,n){if(Math.abs(t.selectedPoint.x-e.x)<=5&&Math.abs(t.selectedPoint.y-e.y)<=5)return i=!0,r=n,!1})),i){var o=f.ControlResize[r].call(this,e),s=o.minX,a=o.minY,l=o.maxX,u=o.maxY;this.start=new f.Point(s,a),this.end=new f.Point(l,u)}else{var c=this.selectedPoint.x-e.x,d=this.selectedPoint.y-e.y;this.start.x=this.prevStart.x-c,this.end.x=this.prevEnd.x-c,this.start.y=this.prevStart.y-d,this.end.y=this.prevEnd.y-d}}}]),d}(d.default);t.default=v},65:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=i(n(143)),a=i(n(626)),l=i(n(803)),u=i(n(368)),c=i(n(643)),d=n(721);var f=function(e){(0,a.default)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.default)(t);if(n){var r=(0,u.default)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,l.default)(this,e)});function c(e,t,n){var o;(0,r.default)(this,c);var a=new d.Point(e.x+10+20,e.y+10+24);return(o=i.call(this,e,a,n)).parent=t,o.padding=5,o.text="",o.type="text",o.endEdit=o.endEdit.bind((0,s.default)(o)),o.onChange=o.onChange.bind((0,s.default)(o)),o}return(0,o.default)(c,[{key:"draw",value:function(e){var t=0;this.text&&(e.save(),e.font=this.config.font,t=e.measureText(this.text).width,e.restore()),e.save();var n=this.start.x+2*this.padding+t;this.end.x<n&&(this.end.x=n);var i=d.Util.getFontHeight(this.config.font),r=this.start.y+2*this.padding+i;this.end.y<r&&(this.end.y=r);var o=Math.abs(this.start.x-this.end.x),s=Math.abs(this.start.y-this.end.y);if(this.editMode||this.selected){var a=Math.min(this.start.x,this.end.x),l=Math.min(this.start.y,this.end.y);e.strokeRect(a-.5,l-.5,o,s)}if(!this.editMode){var u=this.getPoints(),c=u.minX,f=u.minY,h=this.padding+c,v=this.padding+f+i;e.font=this.config.font,e.fillStyle=this.config.color,e.fillText(this.text,h,v),e.restore()}this.selected&&this.drawSelected(e)}},{key:"beginEdit",value:function(){this.editMode=!0,this.input=document.createElement("input"),this.input.type="text",this.input.className="text-editor",this.input.autofocus=!0,this.input.value=this.text,this.input.addEventListener("blur",this.endEdit),this.input.addEventListener("input",this.onChange);var e=this.getPoints(),t=e.minX,n=e.minY,i=e.maxX,r=e.maxY,o=this.input.style;o.top=n+5+"px",o.left=t+5+"px",o.width=i-t-10+"px",o.height=r-n-10+"px",o.lineHeight=r-n-10+"px",o.font=this.config.font,this.parent.frame.appendChild(this.input),this.parent.frame.lastElementChild.focus()}},{key:"endEdit",value:function(){this.editMode=!1,this.text=this.input.value,this.input.removeEventListener("blur",this.endEdit),this.input.parentNode.removeChild(this.input),this.parent.redraw(),this.text&&this.parent.switchSelectMode()}},{key:"onChange",value:function(){this.text=this.input.value,this.parent.redraw();var e=Math.abs(this.start.x-this.end.x);this.input.style.width=e-10+"px"}},{key:"hasText",value:function(){return!!this.text}}]),c}(c.default);t.default=f},416:(e,t,n)=>{var i=n(135),r=i(n(65)),o=i(n(901)),s=i(n(467)),a=i(n(643)),l=i(n(751));t.Text=r.default,t.Arrow=o.default,t.Line=s.default,t.Rect=a.default,t.Ellipse=l.default},96:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=i(n(143)),a=i(n(626)),l=i(n(803)),u=i(n(368)),c=n(416),d=n(721),f=i(n(237));n(750);var h=function(e){(0,a.default)(f,e);var t,n,i=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.default)(t);if(n){var r=(0,u.default)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,l.default)(this,e)});function f(e){var t;(0,r.default)(this,f),(t=i.call(this)).canvas=document.getElementById(e),t.ctx=t.canvas.getContext("2d");var n=t.canvas.parentNode;return t.frame=document.createElement("div"),t.frame.className="wrapper-canvas",n.insertBefore(t.frame,t.canvas),t.canvas.parentNode.removeChild(t.canvas),t.frame.appendChild(t.canvas),t.handlerMouseDown=t.handlerMouseDown.bind((0,s.default)(t)),t.handlerMouseMove=t.handlerMouseMove.bind((0,s.default)(t)),t.handlerMouseUp=t.handlerMouseUp.bind((0,s.default)(t)),t.handlerClick=t.handlerClick.bind((0,s.default)(t)),t.handlerDblClick=t.handlerDblClick.bind((0,s.default)(t)),console.log("Painter: ",(0,s.default)(t)),t}return(0,o.default)(f,[{key:"init",value:function(){this.elements=[],this.handlerMode={},this.lastMouseX=null,this.lastMouseY=null,this.modeName=null,this.config={fillStyle:null,strokeStyle:null,font:"normal normal 12px 宋体",color:"#000000"},this.dragging=!1,this.registerHandler("select",this.selectHandler()),this.registerHandler("remove",this.removeHandler()),this.registerHandler("line",this.lineHandler()),this.registerHandler("arrow",this.arrowHandler()),this.registerHandler("rect",this.rectHandler()),this.registerHandler("text",this.textHandler()),this.registerHandler("ellipse",this.ellipseHandler()),this.bind(),console.log("painter 的 init被调用：",this),console.log("this.handlerMode: ",this.handlerMode),window.painter=this}},{key:"selectHandler",value:function(){var e=this;return{down:function(t){e.dragging=!0,e.selectElement(t)},move:function(t){if(e.selectedElement&&e.dragging){var n=t.offsetX,i=t.offsetY,r=new d.Point(n,i);e.selectedElement.selectedMoveHandler(r),e.redraw()}},up:function(){e.dragging=!1}}}},{key:"removeHandler",value:function(){var e=this;return{down:function(t){e.removeElement(t)}}}},{key:"lineHandler",value:function(){var e=this;return{move:function(t){var n=t.offsetX,i=t.offsetY,r=new d.Point(n,i),o=e.getConfig(),s=new c.Line(e.mouseDownPoint,r,o);e.redraw(),s.draw(e.ctx)},up:function(t){var n=t.offsetX,i=t.offsetY;if(e.mouseUpPoint=new d.Point(n,i),d.Util.distance(e.mouseDownPoint,e.mouseUpPoint)<=40)e.redraw();else{var r=e.getConfig(),o=new c.Line(e.mouseDownPoint,e.mouseUpPoint,r);e.setSelected(o,e.mouseUpPoint),e.redraw(o)}}}}},{key:"arrowHandler",value:function(){var e=this;return{move:function(t){var n=t.offsetX,i=t.offsetY,r=new d.Point(n,i),o=e.getConfig(),s=new c.Arrow(e.mouseDownPoint,r,o);e.redraw(),s.draw(e.ctx)},up:function(t){var n=t.offsetX,i=t.offsetY;if(e.mouseUpPoint=new d.Point(n,i),d.Util.distance(e.mouseDownPoint,e.mouseUpPoint)<=40)e.redraw();else{var r=e.getConfig(),o=new c.Arrow(e.mouseDownPoint,e.mouseUpPoint,r);e.setSelected(o,e.mouseUpPoint),e.redraw(o)}}}}},{key:"rectHandler",value:function(){var e=this;return{move:function(t){var n=t.offsetX,i=t.offsetY,r=new d.Point(n,i),o=e.getConfig(),s=new c.Rect(e.mouseDownPoint,r,o);e.redraw(),s.draw(e.ctx)},up:function(t){var n=t.offsetX,i=t.offsetY;if(e.mouseUpPoint=new d.Point(n,i),d.Util.distance(e.mouseDownPoint,e.mouseUpPoint)<=40)e.redraw();else{var r=e.getConfig(),o=new c.Rect(e.mouseDownPoint,e.mouseUpPoint,r);e.setSelected(o,e.mouseUpPoint),e.redraw(o)}}}}},{key:"ellipseHandler",value:function(){var e=this;return{move:function(t){var n=t.offsetX,i=t.offsetY,r=new d.Point(n,i),o=e.getConfig(),s=new c.Ellipse(e.mouseDownPoint,r,o);e.redraw(),s.draw(e.ctx)},up:function(t){var n=t.offsetX,i=t.offsetY;if(e.mouseUpPoint=new d.Point(n,i),d.Util.distance(e.mouseDownPoint,e.mouseUpPoint)<=40)e.redraw();else{var r=e.getConfig(),o=new c.Ellipse(e.mouseDownPoint,e.mouseUpPoint,r);e.setSelected(o,e.mouseUpPoint),e.redraw(o)}}}}},{key:"textHandler",value:function(){var e=this;return{down:null,click:function(t){var n=t.offsetX,i=t.offsetY,r=new d.Point(n,i),o=e.getConfig(),s=new c.Text(r,e,o);e.setSelected(s,r,!0),s.beginEdit(),e.redraw(s)}}}},{key:"registerHandler",value:function(e,t){var n=this;t.down||(t.down=function(e){var t=e.offsetX,i=e.offsetY;n.mouseDownPoint=new d.Point(t,i)}),t.move||(t.move=function(){}),t.up||(t.up=function(){}),this.handlerMode[e]=t}},{key:"selectElement",value:function(e){for(var t=e.offsetX,n=e.offsetY,i=new d.Point(t,n),r=!1,o=this.elements.length-1;o>=0;o--){var s=this.elements[o];s.isSelected(i)&&!r?(s.setSelected(!0,i),this.selectedElement=s,r=!0):s.setSelected(!1,null)}r?this.elements.filter((function(e){return!e.getSelected()})).forEach((function(e){e.setSelected(!1,null)})):(this.elements.forEach((function(e){e.setSelected(!1,null)})),this.selectedElement=null),this.redraw()}},{key:"removeElement",value:function(e){var t=this;this.selectElement(e),this.selectedElement&&(this.elements=this.elements.filter((function(e){return e!==t.selectedElement})),this.selectedElement=null,this.redraw())}},{key:"setSelected",value:function(e,t,n){this.selectedElement&&this.selectedElement.setSelected(!1,null),e.setSelected(!0,t),this.selectedElement=e,n||this.switchSelectMode()}},{key:"bind",value:function(){this.canvas.addEventListener("mousedown",this.handlerMouseDown),this.canvas.addEventListener("click",this.handlerClick),this.canvas.addEventListener("dblclick",this.handlerDblClick)}},{key:"getConfig",value:function(){return Object.assign({},this.config)}},{key:"setConfig",value:function(e){this.config=e,this.onSettingChange(e)}},{key:"setConfigValue",value:function(e,t){this.config[e]=t,this.onSettingChange(this.config)}},{key:"getSelectedConfig",value:function(){return this.selectedElement&&this.selectedElement.getConfig(),this.getConfig()}},{key:"getModeName",value:function(){return this.modeName}},{key:"setModeName",value:function(e){this.modeName=e}},{key:"handlerMouseDown",value:function(e){var t=this.modeName;t&&this.handlerMode[t]&&(this.handlerMode[t].down(e),this.lastMouseX=e.offsetX,this.lastMouseY=e.offsetY,console.log("handlerMouseDown事件被调用：",this),document.addEventListener("mousemove",this.handlerMouseMove),document.addEventListener("mouseup",this.handlerMouseUp))}},{key:"handlerMouseMove",value:function(e){if("canvas"===e.target.nodeName.toLowerCase()){var t=this.modeName;t&&this.handlerMode[t]&&(this.lastMouseX=e.offsetX,this.lastMouseY=e.offsetY,this.handlerMode[t].move(e))}}},{key:"handlerMouseUp",value:function(e){var t=e.target.nodeName.toLowerCase(),n=e.offsetX,i=e.offsetY;"canvas"!==t&&(n=this.lastMouseX,i=this.lastMouseY);var r=this.modeName;r&&this.handlerMode[r]&&(console.log("handlerMouseUp被触发: (结束的时候，需要移除mousemove和mouseup事件)",this),this.handlerMode[r].up({offsetX:n,offsetY:i}),document.removeEventListener("mousemove",this.handlerMouseMove),document.removeEventListener("mouseup",this.handlerMouseUp))}},{key:"handlerClick",value:function(e){var t=this.modeName;"text"==t&&this.handlerMode[t].click(e)}},{key:"handlerDblClick",value:function(e){if(this.selectElement(e),this.selectedElement){var t=this.selectedElement;"text"===t.type&&(t.beginEdit(),this.redraw())}}},{key:"redraw",value:function(e){var t=this;e&&this.elements.push(e),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.elements.filter((function(e){return!(e.type&&"text"===e.type&&!e.editMode&&!e.hasText())}));n.forEach((function(e){e.draw(t.ctx)})),this.elements=n}},{key:"onSettingChange",value:function(e){this.selectedElement&&(this.selectedElement.setConfig(e),this.redraw())}},{key:"switchSelectMode",value:function(){this.setModeName("select"),this.emit("switchMode","select")}}]),f}(f.default);t.default=h},555:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=function(){function e(t,n){(0,r.default)(this,e),this.parent=n,this.frame=document.getElementById(t),this.bind()}return(0,o.default)(e,[{key:"bind",value:function(){var e=this;this.frame.addEventListener("click",(function(t){var n=t.target;"span"===n.nodeName.toLowerCase()&&(n.classList.contains("selected")?n.classList.remove("selected"):n.classList.add("selected"),e.onChange())}));var t=this.frame.querySelectorAll(".button");Array.from(t).forEach((function(t){"span"!==t.nodeName.toLowerCase()&&t.addEventListener("change",(function(){e.onChange()}))}))}},{key:"getSetting",value:function(){var e=this.frame.querySelectorAll(".button"),t={};Array.from(e).forEach((function(e){var n=e.nodeName.toLowerCase(),i=e.getAttribute("data-name");"span"===n?e.classList.contains("selected")?t[i]=!0:t[i]=!1:t[i]=e.value}));var n={};return["fillStyle","strokeStyle","color"].forEach((function(e){n[e]=t[e]})),n.font=[t.fontStyle?"italic":"normal",t.fontWeight?"bold":"normal",t.fontSize+"px",t.fontFamily].join(" "),n}},{key:"onChange",value:function(){var e=this.getSetting();this.parent.setConfig(e)}},{key:"setSetting",value:function(e){}}]),e}();t.default=s,window.Setting=s},561:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=function(){function e(t,n){(0,r.default)(this,e),this.parent=n,this.frame=document.getElementById(t),this.selected=null,this.bind(),console.log("toolbar对象被创建: ",this)}return(0,o.default)(e,[{key:"bind",value:function(){var e=this;this.frame.addEventListener("click",(function(t){var n=t.target;if(console.log("toolbar按钮事件被触发：",e),!n.classList.contains("button"))return!1;e.selected&&e.selected.classList.remove("selected"),e.selected=n,e.selected.classList.add("selected");var i=e.selected.getAttribute("data-name");e.onChange(i)}))}},{key:"setMode",value:function(e){var t=this,n=this.frame.querySelectorAll(".button");Array.from(n).forEach((function(n){var i=n.getAttribute("data-name");e===i?(n.classList.add("selected"),t.selected=n):n.classList.remove("selected")}))}},{key:"onChange",value:function(e){this.parent.setModeName(e)}}]),e}();t.default=s,window.Toolbar=s},912:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={0:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n-=this.selectedPoint.x-e.x,minY:i-=this.selectedPoint.y-e.y,maxX:r,maxY:o}},1:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n,minY:i-=this.selectedPoint.y-e.y,maxX:r,maxY:o}},2:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY,s=this.selectedPoint.x-e.x;return{minX:n,minY:i-=this.selectedPoint.y-e.y,maxX:r-=s,maxY:o}},3:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n,minY:i,maxX:r-=this.selectedPoint.x-e.x,maxY:o}},4:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n,minY:i,maxX:r-=this.selectedPoint.x-e.x,maxY:o-=this.selectedPoint.y-e.y}},5:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n,minY:i,maxX:r,maxY:o-=this.selectedPoint.y-e.y}},6:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n-=this.selectedPoint.x-e.x,minY:i,maxX:r,maxY:o-=this.selectedPoint.y-e.y}},7:function(e){var t=this.getPoints(this.prevStart,this.prevEnd),n=t.minX,i=t.minY,r=t.maxX,o=t.maxY;return{minX:n-=this.selectedPoint.x-e.x,minY:i,maxX:r,maxY:o}}}},237:(e,t,n)=>{var i=n(135),r=i(n(296)),o=i(n(0)),s={emitDelay:0,strictMode:!1},a=function(){function e(){var t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;(0,r.default)(this,e),t=i.hasOwnProperty("emitDelay")?i.emitDelay:s.emitDelay,this._emitDelay=t,n=i.hasOwnProperty("strictMode")?i.strictMode:s.strictMode,this._strictMode=n,this._listeners={},this.events=[]}return(0,o.default)(e,[{key:"_addListenner",value:function(e,t,n){if("function"!=typeof t)throw TypeError("listener must be a function");-1===this.events.indexOf(e)?(this._listeners[e]=[{once:n,fn:t}],this.events.push(e)):this._listeners[e].push({once:n,fn:t})}},{key:"on",value:function(e,t){this._addListenner(e,t,!1)}},{key:"once",value:function(e,t){this._addListenner(e,t,!0)}},{key:"off",value:function(e,t){var n=this.events.indexOf(e);if(e&&-1!==n)if(t){var i=[],r=this._listeners[e];r.forEach((function(e,n){e.fn===t&&i.unshift(n)})),i.forEach((function(e){r.splice(e,1)})),r.length||(this.events.splice(n,1),delete this._listeners[e])}else delete this._listeners[e],this.events.splice(n,1)}},{key:"_applyEvents",value:function(e,t){var n=this._listeners[e];if(n&&n.length){var i=[];n.forEach((function(e,n){e.fn.apply(null,t),e.once&&i.unshift(n)})),i.forEach((function(e){n.splice(e,1)}))}else if(this._strictMode)throw"No listeners specified for event: "+e}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=this;this._emitDelay?setTimeout((function(){r._applyEvents(e,n)}),r._emitDelay):this._applyEvents(e,n)}},{key:"emitSync",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this._applyEvents(e,n)}},{key:"destroy",value:function(){this._listeners={},this.events=[]}}]),e}();e.exports=a},245:(e,t,n)=>{var i=n(135);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(296)),o=i(n(0)),s=function(){function e(t,n){(0,r.default)(this,e),this.x=t,this.y=n}return(0,o.default)(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"toString",value:function(){return"x:".concat(this.x,";y:").concat(this.y)}}]),e}();t.default=s},656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={distance:function(e,t){var n=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return Math.sqrt(n*n+i*i)},getMaxMin:function(e,t){return{minX:Math.min(e.x,t.x),maxX:Math.max(e.x,t.x),minY:Math.min(e.y,t.y),maxY:Math.max(e.y,t.y)}},drawEllipse:function(e,t,n,i,r,o,s){e.save();var a=i>r?i:r,l=i/a,u=r/a;e.scale(l,u),e.beginPath(),e.moveTo((t+i)/l,n/u),e.arc(t/l,n/u,a,0,2*Math.PI),o&&(e.fillStyle=o,e.fill()),e.closePath(),s&&(e.strokeStyle=s),e.stroke(),e.restore()},drawArrow:function(e,t,n,i,r,o,s,a,l){s=void 0!==s?s:30,a=void 0!==a?a:10,l=void 0!==l?l:1,o="color"!=typeof o?o:"#000";var u=180*Math.atan2(n-r,t-i)/Math.PI,c=(u+s)*Math.PI/180,d=(u-s)*Math.PI/180,f=a*Math.cos(c),h=a*Math.sin(c),v=a*Math.cos(d),p=a*Math.sin(d);e.save(),e.beginPath();var m=t-f,y=n-h;e.moveTo(m,y),e.moveTo(t,n),e.lineTo(i,r),m=i+f,y=r+h,e.moveTo(m,y),e.lineTo(i,r),m=i+v,y=r+p,e.lineTo(m,y),e.strokeStyle=o,e.lineWidth=l,e.stroke(),e.restore()},fontHeightCache:{},fontWidthCache:{},getFontHeight:function(e){if(this.fontHeightCache[e])return this.fontHeightCache[e];var t=document.createElement("div");return t.style.height="1px",t.style.width="10000px",t.style.font=e,t.style.overflow="hidden",t.innerHTML="字体高度",document.body.appendChild(t),this.fontHeightCache[e]=t.scrollHeight,t.parentNode.removeChild(t),this.fontHeightCache[e]},getFontWidth:function(e){}};t.default=n},721:(e,t,n)=>{var i=n(135),r=i(n(245)),o=i(n(656)),s=i(n(912));t.Point=r.default,t.Util=o.default,t.ControlResize=s.default},89:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(476),r=n.n(i),o=n(705),s=n.n(o)()(r());s.push([e.id,".wrapper-canvas{\n    position:relative;\n}\n.text-editor{\n    position:absolute;\n    border:none;\n    background:transparent;\n    outline:none;\n    padding:0;\n}","",{version:3,sources:["webpack://./src/Painter.css"],names:[],mappings:"AAAA;IACI,iBAAiB;AACrB;AACA;IACI,iBAAiB;IACjB,WAAW;IACX,sBAAsB;IACtB,YAAY;IACZ,SAAS;AACb",sourcesContent:[".wrapper-canvas{\n    position:relative;\n}\n.text-editor{\n    position:absolute;\n    border:none;\n    background:transparent;\n    outline:none;\n    padding:0;\n}"],sourceRoot:""}]);const a=s},750:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var i=n(379),r=n.n(i),o=n(795),s=n.n(o),a=n(569),l=n.n(a),u=n(565),c=n.n(u),d=n(216),f=n.n(d),h=n(589),v=n.n(h),p=n(89),m={};m.styleTagTransform=v(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=f(),r()(p.Z,m);const y=p.Z&&p.Z.locals?p.Z.locals:void 0},379:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],u=i.base?l[0]+i.base:l[0],c=o[u]||0,d="".concat(u," ").concat(c);o[u]=c+1;var f=n(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)t[f].references++,t[f].updater(h);else{var v=r(h,i);i.byIndex=a,t.splice(a,0,{identifier:d,updater:v,references:1})}s.push(d)}return s}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var l=i(e,r),u=0;u<o.length;u++){var c=n(o[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}o=l}}},569:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},143:e=>{e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},296:e=>{e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},0:(e,t,n)=>{var i=n(616);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},52:(e,t,n)=>{var i=n(428);function r(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(e,t,n){var r=i(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},368:e=>{function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},626:(e,t,n)=>{var i=n(595);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},135:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},803:(e,t,n)=>{var i=n(435).default,r=n(143);e.exports=function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},595:e=>{function t(n,i){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},428:(e,t,n)=>{var i=n(368);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},772:(e,t,n)=>{var i=n(435).default;e.exports=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},616:(e,t,n)=>{var i=n(435).default,r=n(772);e.exports=function(e){var t=r(e,"string");return"symbol"===i(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},435:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,exports:{}};return e[i](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,(()=>{var e=n(135),t=e(n(96)),i=e(n(555)),r=e(n(561));console.log("canvas-painter");var o=new t.default("canvas"),s=new i.default("setting",o),a=new r.default("tool",o);o.init(),s.onChange(),o.on("switchMode",(function(e){a.setMode(e)}))})()})();
//# sourceMappingURL=index-565762.js.map