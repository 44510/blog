---
title: 优化云信视频
date: 2020-11-09
tags:
  - 云信视频
  - 小程序端
  - PC
categories:
  - [云信视频]
  - [小程序]
  - [性能优化]
---

## 目前项目介绍，版本 1

### 应用场景

### 技术选型

### 开发遇到的问题（坑）

## 遇到的问题

Dear All,
互联网医院 V1.2.0-网络诊间版本测试已通过，已于 11 月 3 日正式发布。感谢研发、测试、设计等团队在此期间的辛勤付出，确保顺利上线。

发布内容

患者端 -H5
【网络诊间】新增网络诊间模块支持预约最近 5 天的号源，支持在线支付；本次暂不支持预约当日号。
【网络诊间订单】新增个人网络诊间订单，可以查看历次网络诊间记录，包含诊断、处方等。

患者端-小程序
【候诊室】新增候诊室功能，入口在患者端首页。支持患者在就诊当日对应时间段在候诊室进行排队候诊，当医生向患者发起视频邀请，接受后建立视频通话，进行视频问诊。

运营系统
【排班管理】新增网络诊间排班功能，支持对网络诊间医生进行排班及号源设置。支持停诊、复制排班、新增/调整排班。
【医生管理】新增医生管理模块，支持对互联网医院医生进行增、改、查等操作。

医生端-pc
【就诊列表】新增就诊列表，展示当前时间段所有候诊间排队患者，医生可以按次序向患者发起视频邀请，支持过号等操作。视频期间支持为患者填写诊断、开具处方。
【已完成列表】新增已完成列表，展示当日所有就诊患者。支持为已完成网络诊间服务的患者写诊断、开具处方。

医生端-APP
【网络诊间】新增网络诊间模块，按状态显示所有网络诊间订单。支持在 APP 为患者写诊断、开具处方。

测试环境：
小程序体验版，需要的要先加体验权限，小程序二维码，

1. 患者端 h5 及小程序，http://static.qa.91jkys.com/f2e/minses/#/，需要微信内访问
2. 运营系统，http://static.qa.91jkys.com/web/minses-admin/operation-management/#/admin-navigation?type=wlzj
3. 医生端 pc，https://static.qa.91jkys.com/web/minses-admin/workbench/#/login

线上演示环境：
目前小程序正在提交审核中

1.  患者端 h5 及小程序， http://minses.91jkys.com/qa/minses/qatest-minses/#/
2.  运营系统，http://static.pre.91jkys.com/web/minses-admin/operation-management/#/admin-navigation
3.  医生端 pc，https://static.pre.91jkys.com/web/minses-admin/workbench/#/login

注：本次遗留较多体验问题以及因为云信造成的视频边界问题，后续版本会次序优化，在对外使用前达到体验标准。以下为本次主要遗留的问题及风险点

延期处理：
【视频问诊】待接听页面 后台运行 再次点击进去 没有声音
【视频问诊】pc 端视频问诊 未进入房间的时候 显示白屏（偶现）
【视频问诊】视频问诊 进去房间之后 患者端在后台运行 然后再次进去视频之后 计时停止了
【pc 登录】新增加的医生 点击登录的时候 报用户不存在 （具体原因没有排除出来，下次出现的时候再次排查）
【视频问诊】视屏过程中接电话 重新连接页面卡住
【视频问诊】xsmax 机型接通视屏偶现白屏
【视频问诊】当患者端将小程序放到后台，医生端读秒加快，翻倍计时
【医生端 APP】网络问诊》已完成的患者，点击患者进如患者主页出现报错
【pc 端】视频弹框，拖动不灵敏
风险点
1）未接通视频的时候，医生刷新与断网引发的边界问题情况暂未考虑
2）接通视频之后，医生断网情况暂未考虑
3）患者断网之后 中间收到断网的那几秒时间 进去房间可能异常 4)业务方无法实现预约失败的场景，暂不测试关于预约失败和预约失败退款的情况
5）医生和患者的账号正常使用的时候被删除，（偶现，没有排除出原因）
6）视频实际投放的封面图，这期没有（下期优化）
6）综合本次网络诊间的测试情况，线上实际投入使用，需要测试这边参考实际使用的医院实际场景进行回归测试。

## 如何优化

针对问题如何具体优化功能点及架构的调整。

## 结果
