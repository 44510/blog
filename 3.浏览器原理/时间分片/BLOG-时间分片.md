---
title: 时间分片（Time Slicing）
date:
tags:
  - JS
  - 时间分片
  - 浏览器原理
categories:
  - [浏览器原理, 时间分片]
  - [JS]
---

[时间分片（Time Slicing）](https://blog.csdn.net/liuyifeng0000/article/details/104785042/)

## 时间分片核心思想

时间分片的**核心思想**是：如果任务不能在 50 毫秒内执行完，那么为了不阻塞主线程，这个任务应该让出主线程的控制权，使浏览器可以处理其他任务。让出控制权意味着停止执行当前任务，让浏览器去执行其他任务，随后再回来继续执行没有执行完的任务。

所以**时间分片的目的是不阻塞主线程**，而**实现目的的技术手段是将一个长任务拆分成很多个不超过 50ms 的小任务分散在宏任务队列中执行**。

时间分片是一项使用得比较广的技术方案，它的本质就是将长任务分割为一个个执行时间很短的任务，然后再一个个地执行。

这个概念在我们日常的性能优化上是非常有用的。

例如当我们需要在页面中一次性插入一个长列表时（当然，通常这种情况，我们会使用分页去做）。

如果利用时间分片的概念来实现这个功能，我们可以使用 **requestAnimationFrame+DocumentFragment**。

对比一般的页面渲染和使用了时间分片的方式，差别还是很明显的。

## 时间切片的缺点

使用时间切片的缺点是，任务运行的总时间变长了，这是因为它每处理完一个小任务后，主线程会空闲出来，并且在下一个小任务开始处理之前有一小段延迟。

但是**为了避免卡死浏览器**，这种取舍是很有必要的。
